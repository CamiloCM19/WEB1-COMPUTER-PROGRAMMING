<!DOCTYPE html>
<html lang="es" data-theme="light">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>BOLIVAR MATH ARENA</title>

  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"/>

  <link rel="preconnect" href="https://fonts.googleapis.com"/>
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin/>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700;800&family=Space+Mono:wght@700&display=swap" rel="stylesheet"/>
  <link rel="stylesheet" href="styles.css"/>
</head>
<body>

<canvas id="confettiCanvas" class="confetti"></canvas>

  <div id="start-screen">
      <img src="https://res.cloudinary.com/disfxr4oa/image/upload/v1758131474/20250917_1241_Escudo_Matem%C3%A1tico_Bol%C3%ADvar_remix_01k5cc6eayejkr1j98sm0kazvd_yjqbgd.png" alt="Logo Bolivar Math Arena" class="start-logo">
      <h1 class="start-title">BOLIVAR MATH ARENA</h1>
      <div class="start-buttons">
        <button id="start-button" class="start-button">Empezar</button>
        <button id="achievements-button" class="achievements-button">Ver logros</button>
      </div>
      <div class="scoreboard">
          <div class="label">Mejor puntuación</div>
          <div id="home-best-score" class="score-value">0</div>
      </div>
  </div>

  <main class="game-container hidden">

    <header class="game-header">
      <div class="lore-brand">
        <img src="https://res.cloudinary.com/disfxr4oa/image/upload/v1758131474/20250917_1241_Escudo_Matem%C3%A1tico_Bol%C3%ADvar_remix_01k5cc6eayejkr1j98sm0kazvd_yjqbgd.png" alt="Logo" class="crest">
        <span>BOLIVAR MATH ARENA</span>
      </div>
      <div class="missions">
        <ul class="nav nav-tabs" role="tablist">
          <li class="nav-item" role="presentation"><a class="nav-link active" href="#" id="tabSuma" aria-current="page" role="tab"><svg class="chip-icon" viewBox="0 0 24 24" aria-hidden="true"><path fill="currentColor" d="M11 3h2v18h-2zM3 11h18v2H3z"/></svg> Addition Arena</a></li>
          <li class="nav-item" role="presentation"><a class="nav-link" href="#" id="tabEncontrarX" role="tab"><svg class="chip-icon" viewBox="0 0 24 24" aria-hidden="true"><path fill="currentColor" d="m6 18 12-12M18 18 6 6"/></svg> X (+) Arena</a></li>
        </ul>
      </div>
    </header>

    <div class="game-screen">
      <div class="mentor" aria-live="polite" aria-atomic="true">
        <div class="mentor-avatar" aria-hidden="true">V</div>
        <div class="mentor-bubble">
          <div id="mentorText">Bienvenido. Elige para comenzar.</div>
          <div class="mentor-cta mt-1">Consejo: responde en &lt; <strong>5s</strong> para activar bonus de racha.</div>
        </div>
      </div>

      <div class="hud-grid">
        <div class="stat-pods">
          <div class="stat-pod"><div class="label">VIDAS</div><div id="vidas" class="lives value"></div></div>
          <div class="stat-pod"><div class="label">NIVEL</div><div id="nivelBadge" class="value">1</div></div>
          <div class="stat-pod"><div class="label">COMBO</div><div id="comboBadge" class="value d-none">x1</div></div>
        </div>

        <div class="score-display"><div class="label">PUNTUACIÓN</div><div id="marcador" class="score-badge"><span id="score">0</span></div></div>
        <div class="timer-display" aria-label="Tiempo restante"><div id="timePill"></div><div class="time-text"><span id="timeBaseBig">20</span>s</div><span id="timeBonusSmall" class="d-none"></span></div>

        <div class="powerups-container">
            <div class="powerups-grid">
                <button id="powerup-time" class="powerup-btn" title="Reloj de arena: congela el tiempo 5s (T)" data-powerup="time" disabled>⏳<div class="cooldown-pie"></div></button>
                <button id="powerup-x2" class="powerup-btn" title="Multiplicador x2: duplica los puntos de la siguiente respuesta (D)" data-powerup="x2" disabled>2x<div class="cooldown-pie"></div></button>
                <button id="powerup-skip" class="powerup-btn" title="Pase divino: salta la pregunta actual (P)" data-powerup="skip" disabled>⏭<div class="cooldown-pie"></div></button>
            </div>
        </div>

        <div class="level-progress-bar" aria-label="Progreso del nivel"><span id="levelLabel" class="label">Nivel 1</span><div class="bar" aria-hidden="true"><div id="levelFill" class="fill" style="width:0%"></div></div></div>

        <div class="toolbar">
            <select id="difficulty" class="form-select form-select-sm diff-select" aria-label="Dificultad"><option value="normal" selected>Normal</option><option value="facil">Fácil</option><option value="dificil">Difícil</option><option value="extremo">Extremo</option></select>
            <button id="hintBtn" class="icon-btn" type="button" aria-pressed="false" title="Usar pista (-50 pts, +3s)">Pista</button>
            <button id="explainBtn" class="icon-btn" type="button" aria-expanded="false" aria-controls="panelDidactico">Explicación</button>
            <button id="pauseBtn" class="icon-btn" type="button" aria-pressed="false">Pausar</button>
            <button id="resetBtn" class="icon-btn" type="button">Reiniciar</button>
            <button id="themeToggle" class="icon-btn" type="button" title="Tema (C)">Tema</button>
            <button id="soundToggle" class="icon-btn" type="button" aria-pressed="true" title="Sonido (S)">Sonido: ON</button>
            <button id="numpadToggle" class="icon-btn" type="button" aria-pressed="false">Teclado</button>
        </div>
      </div>

      <div class="operacion-container text-center my-3" aria-live="polite" aria-atomic="true"><span class="slot" id="operando1">5</span><span id="operador" class="mx-1">+</span><span class="slot" id="operando2">3</span><span class="mx-1">=</span><span class="slot slot-x" id="resultado">?</span></div>

      <div class="input-group mb-3"><input type="number" inputmode="numeric" id="respuestaUsuario" class="form-control form-control-lg text-center" placeholder="Tu respuesta" aria-label="Tu respuesta" autofocus><button class="btn btn-primary" type="button" id="btnComprobar" aria-label="Comprobar respuesta">Comprobar</button></div>
      <div id="feedback" class="feedback-container text-center mt-3" aria-live="polite"></div>

      <div id="numpad" class="numpad d-none mb-3">...</div>
      <div id="panelDidactico" class="didactico d-none">...</div>
    </div>
  </main>

  <div id="toast" class="toast-lite" role="status" aria-live="polite"></div>

  <div class="modal fade" id="gameOverModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content">
        <div class="modal-header"><h5 class="modal-title go-title">Game Over</h5><button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Cerrar"></button></div>
        <div class="modal-body">
          <div class="mb-3 text-center"><h6 class="mb-1">Tu puntuación</h6><div class="display-4 fw-bold" id="finalScore">0</div><div class="text-muted small">Mejor puntuación: <span id="bestScore">0</span></div></div>
          <div class="row g-2 mb-3">
            <div class="col-6"><div class="stat-card h-100"><p class="stat-title">Aciertos</p><p class="stat-value" id="statAciertos">0</p></div></div>
            <div class="col-6"><div class="stat-card h-100"><p class="stat-title">Mejor racha</p><p class="stat-value" id="statRacha">0</p></div></div>
            <div class="col-6"><div class="stat-card h-100"><p class="stat-title">Tiempo medio</p><p class="stat-value" id="statPromedio">0.0s</p></div></div>
            <div class="col-6"><div class="stat-card h-100"><p class="stat-title">Mejor tiempo</p><p class="stat-value" id="statMejor">--</p></div></div>
          </div>
          <div><h6 class="mb-2 text-center">Hitos desbloqueados en esta partida</h6><div id="hitosList" class="d-flex flex-wrap gap-2 justify-content-center"></div></div>
        </div>
        <div class="modal-footer"><button id="btnReiniciar" type="button" class="btn btn-primary w-100">Volver al inicio</button></div>
      </div>
    </div>
  </div>

  <div class="modal fade" id="achievementsModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-lg">
      <div class="modal-content">
        <div class="modal-header"><h5 class="modal-title ach-title">Galería de hitos</h5><button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Cerrar"></button></div>
        <div class="modal-body">
          <p class="text-center text-muted mb-4">Desbloquea todos los hitos para demostrar tu nivel en la arena.</p>
          <div id="achievements-grid" class="achievement-grid"></div>
        </div>
      </div>
    </div>
  </div>


  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  <script src="script.js" defer></script>
</body>
</html>
